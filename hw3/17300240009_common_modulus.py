import gmpy2

def attack(c1, c2, e1, e2, n):
   # WRITE YOUR CODE HERE!
   s = gmpy2.gcdext(e1, e2)
   s1 = s[1]
   s2 = s[2]
   tmp1 = gmpy2.powmod(c1, s1, n)
   tmp2 = gmpy2.powmod(c2, s2, n)
   return (tmp1*tmp2)%n
   




n = 103109065902334620226101162008793963504256027939117020091876799039690801944735604259018655534860183205031069083254290258577291605287053538752280231959857465853228851714786887294961873006234153079187216285516823832102424110934062954272346111907571393964363630079343598511602013316604641904852018969178919051627
ct1 = 89165267757592056998430515273393236824675618209628120636976415324541608777639312906328761896196335563918995813065446097111511299622583559521279416118344262659587873497494326049565077208391797840846364711580568322182209616487454086620832166912794622826357529165185122310658553888175629604486544265939860652568
e1 = 15
ct2 = 20135243573102312365489445555179471711050237357771531944565197207909056856791452660071533981351813615406042686828666883602743565692680466225128878907776339638498888836642920122809284690243270675115097201512434337054133554094147631311406424433602757215625092846913693790078424458624369228575776016743532946934
e2 = 13


print ('[+] Started attack...')

message = attack(ct1, ct2, e1, e2, n)
print('message: ',message)

print ('[+] Attack finished!')
#print(len(hex(message)[2:]))



print('\nPlaintext: \n ' + bytearray.fromhex(hex(message)[2:]).decode())



